<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Ito et al. 2018 • jlmerclusterperm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Ito et al. 2018">
<meta name="description" content="Interpreting main effects and interaction effects in a CPA">
<meta property="og:description" content="Interpreting main effects and interaction effects in a CPA">
<meta property="og:image" content="https://yjunechoe.github.io/jlmerclusterperm/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">jlmerclusterperm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/jlmerclusterperm.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Topics</h6></li>
    <li><a class="dropdown-item" href="../articles/tidying-output.html">Tidying output</a></li>
    <li><a class="dropdown-item" href="../articles/julia-interface.html">Julia interface</a></li>
    <li><a class="dropdown-item" href="../articles/reproducibility.html">Reproducibility</a></li>
    <li><a class="dropdown-item" href="../articles/asynchronous-cpa.html">Asynchronous CPA</a></li>
    <li><a class="dropdown-item" href="../articles/eyetrackingR-comparison.html">Comparison to eyetrackingR</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/Garrison-et-al-2020.html">Garrison et al. 2020</a></li>
    <li><a class="dropdown-item" href="../articles/Geller-et-al-2020.html">Geller et al. 2020</a></li>
    <li><a class="dropdown-item" href="../articles/deCarvalho-et-al-2021.html">de Carvalho et al. 2021</a></li>
    <li><a class="dropdown-item" href="../articles/Ito-et-al-2018.html">Ito et al. 2018</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yjunechoe/jlmerclusterperm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Ito et al. 2018</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yjunechoe/jlmerclusterperm/blob/HEAD/vignettes/articles/Ito-et-al-2018.Rmd" class="external-link"><code>vignettes/articles/Ito-et-al-2018.Rmd</code></a></small>
      <div class="d-none name"><code>Ito-et-al-2018.Rmd</code></div>
    </div>

    
    
<p>This tutorial is a guide on interpreting main effects and interaction
effects in a CPA.</p>
<p>See more tutorials and vignettes on the <a href="https://yjunechoe.github.io/jlmerclusterperm/articles">Articles</a>
page.</p>
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>The data is from an eyetracking study by <a href="https://doi.org/10.1016/j.jml.2017.09.002" class="external-link">Ito, Pickering, &amp;
Corley (2018)</a> “Investigating the time-course of phonological
prediction in native and non-native speakers of English: A visual world
eye-tracking study”. The data file comes by way of a <a href="https://github.com/aineito/stats.VWP/blob/main/inst/tutorials/CPA/CPA.Rmd" class="external-link">CPA
tutorial by Aine Ito</a>, as part of a complement to a large survey
paper on eyetracking data analysis methods (<a href="https://doi.org/10.3758/s13428-022-01969-3" class="external-link">Ito &amp; Knoeferle
(2023)</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yjunechoe/jlmerclusterperm" class="external-link">jlmerclusterperm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/jlmerclusterperm_setup.html">jlmerclusterperm_setup</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Other packages for this tutorial</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nsgrantham.github.io/ggbraid/" class="external-link">ggbraid</a></span><span class="op">)</span> <span class="co"># remotes::install_github("nsgrantham/ggbraid")</span></span>
<span></span>
<span><span class="co"># Download data (called `fix.50bin`)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/aineito/stats.VWP/main/data/fix.50bin.rda"</span></span>
<span>  <span class="va">datafile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">url</span>, <span class="va">datafile</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">datafile</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">fix.50bin</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 28,680</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ Subject        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> j1, j1, j1, j1, j1, j1, j1, j1, j1, j1, j1, j1, j1, j1,…</span></span>
<span><span class="co">#&gt; $ Trial          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5…</span></span>
<span><span class="co">#&gt; $ Time           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1000, -950, -900, -850, -800, -750, -700, -650, -600, …</span></span>
<span><span class="co">#&gt; $ allSample      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25,…</span></span>
<span><span class="co">#&gt; $ Count          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ BlinkCount     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ OffScreenCount <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span></span>
<span><span class="co">#&gt; $ FixP           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, …</span></span>
<span><span class="co">#&gt; $ Condition      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Targ, Targ, Targ, Targ, Targ, Targ, Targ, Targ, Targ, T…</span></span>
<span><span class="co">#&gt; $ Item           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5…</span></span>
<span><span class="co">#&gt; $ Lang           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> L2, L2, L2, L2, L2, L2, L2, L2, L2, L2, L2, L2, L2, L2,…</span></span></code></pre></div>
<p>The complete data dictionary is reproduced from the original tutorial
in the collapsible details below:</p>
<details><summary>
Data dictionary of <code>fix.50bin</code>
</summary><table class="table">
<colgroup>
<col width="19%">
<col width="80%">
</colgroup>
<thead><tr class="header">
<th align="left">Column</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Subject</td>
<td align="left">Subject ID</td>
</tr>
<tr class="even">
<td align="left">Trial</td>
<td align="left">Trial number</td>
</tr>
<tr class="odd">
<td align="left">Time</td>
<td align="left">Time relative to the target word onset (Time -1000
contains 50 ms from the time -1000 ms)</td>
</tr>
<tr class="even">
<td align="left">allSample</td>
<td align="left">The sum of all samples in the corresponding time
bin</td>
</tr>
<tr class="odd">
<td align="left">Count</td>
<td align="left">Right-eye sample count on the critical object</td>
</tr>
<tr class="even">
<td align="left">BlinkCount</td>
<td align="left">The total number of right-eye samples that were in a
blink event</td>
</tr>
<tr class="odd">
<td align="left">OffScreenCount</td>
<td align="left">The total number of right-eye samples that fall outside
of the display boundary (off screen)</td>
</tr>
<tr class="even">
<td align="left">FixP</td>
<td align="left">Fixation proportion</td>
</tr>
<tr class="odd">
<td align="left">Condition</td>
<td align="left">Condition (Targ=target, Eng=English competitor,
Jap=Japanese competitor, Unr=unrelated)</td>
</tr>
<tr class="even">
<td align="left">Item</td>
<td align="left">Item ID</td>
</tr>
<tr class="odd">
<td align="left">Lang</td>
<td align="left">Language group (L1=native English speakers, L2=native
Japanese, non-native English speakers)</td>
</tr>
</tbody>
</table></details><p>For the purposes of this vignette, we take a subset of the data to
focus on just the effects of interest. We first derive the response
variable used in the original tutorial <code>elogFix</code> for the
“empirical logit” (<a href="https://doi.org/10.1016/j.jml.2007.09.002" class="external-link">Barr, 2013</a>; but see
<a href="https://doi.org/10.1016/j.jml.2016.10.005" class="external-link">Donnelly &amp;
Verkuilen, 2017</a>) and then also subset the levels of
<code>Condition</code> (target <code>"Targ"</code> vs. unrelated
<code>"Unr"</code>) and <code>Lang</code> (native <code>"L1"</code>
vs. non-native <code>"L2"</code> speakers) for a 2-by-2 analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix_50bin</span> <span class="op">&lt;-</span> <span class="va">fix.50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    elogFix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">Count</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span><span class="op">/</span></span>
<span>              <span class="op">(</span><span class="va">allSample</span><span class="op">-</span><span class="va">BlinkCount</span><span class="op">-</span><span class="va">OffScreenCount</span><span class="op">-</span><span class="va">Count</span><span class="op">+</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">elogFix</span>, <span class="va">Condition</span>, <span class="va">Lang</span>, <span class="va">Time</span>, <span class="va">Subject</span>, <span class="va">Item</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Lang</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span>, <span class="va">Condition</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Targ"</span>, <span class="st">"Unr"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">fix_50bin</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14,360 × 6</span></span></span>
<span><span class="co">#&gt;    elogFix Condition Lang   Time Subject Item </span></span>
<span><span class="co">#&gt;      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2    -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">000</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">950</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">900</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">850</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">800</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">750</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">700</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">650</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">600</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>   -<span style="color: #BB0000;">3.93</span> Targ      L2     -<span style="color: #BB0000;">550</span> j1      5    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 14,350 more rows</span></span></span></code></pre></div>
<p>Note that the <a href="https://github.com/aineito/stats.VWP/blob/main/inst/tutorials/CPA/CPA.Rmd" class="external-link">original
tutorial</a> conducted two separate CPAs, testing for the effect of
<code>Condition</code> within the <code>Lang=="L1"</code> group and
within the <code>Lang=="L2"</code> group. By comparison,
<a href="https://github.com/yjunechoe/jlmerclusterperm" class="external-link">jlmerclusterperm</a> allows us to estimate the main effects
of both predictors simultaneously, as well as an interaction effect
between the two.</p>
<p>The <code>fix_50bin</code> data prepared for this complete 2-by-2
analysis is plotted below:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_base</span> <span class="op">&lt;-</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">elogFix</span>, color <span class="op">=</span> <span class="va">Lang</span>, linetype <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, linewidth <span class="op">=</span> <span class="fl">2</span>, fun.data <span class="op">=</span> <span class="va">mean_se</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">p_base</span></span></code></pre></div>
<p><img src="Ito-et-al-2018_files/figure-html/p_base-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="contrast-coding-and-cpa-specification">Contrast coding and CPA specification<a class="anchor" aria-label="anchor" href="#contrast-coding-and-cpa-specification"></a>
</h2>
<p>Prior to the CPA, we first apply sum coding to the predictors, to
render the terms in the model matrix orthogonal to each other. This is
important because it allows the model to estimate the main and
interaction effects in the 2-by-2 without losing statistical power.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">fix_50bin</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">fix_50bin</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1]</span></span>
<span><span class="co">#&gt; Targ    1</span></span>
<span><span class="co">#&gt; Unr    -1</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">fix_50bin</span><span class="op">$</span><span class="va">Lang</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.sum</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">fix_50bin</span><span class="op">$</span><span class="va">Lang</span><span class="op">)</span></span>
<span><span class="co">#&gt;    [,1]</span></span>
<span><span class="co">#&gt; L1    1</span></span>
<span><span class="co">#&gt; L2   -1</span></span></code></pre></div>
<p>Using this data, we construct a specification object with
<code><a href="../reference/make_jlmer_spec.html">make_jlmer_spec()</a></code> using the formula
<code>elogFix ~ Condition * Lang</code>. We also include random
intercepts by <code>Subject</code> and <code>Item</code> as in the
original tutorial. Lastly, we specify the grouping structure of
observations in the data, where each row is uniquely identified by a
combination of <code>Subject</code>, <code>Item</code>, and
<code>Time</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">elogFix</span> <span class="op">~</span> <span class="va">Condition</span> <span class="op">*</span> <span class="va">Lang</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Item</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fix_50bin</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Subject"</span>, trial <span class="op">=</span> <span class="st">"Item"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>As a sanity check, we first fit a global model collapsing the time
dimension.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/jlmer.html">jlmer</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;Julia object of type LinearMixedModel&gt;</span></span>
<span><span class="co">#&gt; Variance components:</span></span>
<span><span class="co">#&gt;             Column   Variance Std.Dev. </span></span>
<span><span class="co">#&gt; Subject  (Intercept)  0.668899 0.817862</span></span>
<span><span class="co">#&gt; Item     (Intercept)  0.091145 0.301902</span></span>
<span><span class="co">#&gt; Residual              9.481388 3.079186</span></span>
<span><span class="co">#&gt;  ──────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt;                        Coef.  Std. Error       z  Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; ──────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; (Intercept)        -1.66888     0.142614  -11.70    &lt;1e-30</span></span>
<span><span class="co">#&gt; Condition1          0.946573    0.025939   36.49    &lt;1e-99</span></span>
<span><span class="co">#&gt; Lang1               0.208792    0.12097     1.73    0.0844</span></span>
<span><span class="co">#&gt; Condition1__Lang1   0.194132    0.025939    7.48    &lt;1e-13</span></span>
<span><span class="co">#&gt; ──────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>The original tutorial hypothesized a main effect of
<code>Condition</code>, but no meaningful differences by
<code>Lang</code> (hence the simpler split analysis). The plot and the
model results from above corroborate this as well.</p>
<p>However, notice that there also seems to be a potential interaction
effect, where the difference in the effect of <code>Condition</code>
appears larger within the <code>Lang=="L1"</code> group than within the
<code>Lang=="L2"</code> group, at least in the aggregate:</p>
<details><summary>
Plotting code
</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Lang</span>, <span class="va">elogFix</span>, fill <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.8</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    fun.data <span class="op">=</span> <span class="va">mean_se</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>    position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.8</span><span class="op">)</span>,</span>
<span>    width <span class="op">=</span> <span class="fl">.4</span>,</span>
<span>    fun.data <span class="op">=</span> <span class="va">mean_se</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Global difference in means"</span>, y <span class="op">=</span> <span class="st">"elogFix (reversed)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_reverse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="Ito-et-al-2018_files/figure-html/2by2-aggregate-1.png" width="100%"></p>
<p>Supposing that this relationship is theoretically interesting, we can
use CPA to test for this interaction effect between
<code>Condition</code> and <code>Lang</code>, as well as the main effect
of <code>Condition</code>.</p>
</div>
<div class="section level2">
<h2 id="conducting-the-cpa">Conducting the CPA<a class="anchor" aria-label="anchor" href="#conducting-the-cpa"></a>
</h2>
<p>To stick close to the analysis performed in the original tutorial
(via <code>{permutes}</code>), we conduct a CPA using
<code>statistic = "chisq"</code> and <code>threshold = 0.05</code>. This
makes the CPA use the difference in likelihood as the timewise
statistic, counting only those differences that come out as p&lt;0.05 in
a likelihood ratio (i.e., chi-squared) test.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/julia_rng.html">set_rng_state</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">CPA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterpermute.html">clusterpermute</a></span><span class="op">(</span></span>
<span>    <span class="va">spec</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    nsim <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.24    0.37   97.83</span></span></code></pre></div>
<details><summary>
See full summary of results from <code>CPA</code>
</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA</span></span>
<span><span class="co">#&gt; $null_cluster_dists</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Null cluster-mass distribution</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───── <span style="color: #0000BB;">&lt;null_cluster_dists&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (n = 1000, <span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   Mean (SD): 1.072 (15.89)</span></span>
<span><span class="co">#&gt;   Coverage intervals: 95% [-33.885, 40.086]</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (n = 1000, <span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   Mean (SD): 1.713 (20.98)</span></span>
<span><span class="co">#&gt;   Coverage intervals: 95% [-38.864, 53.217]</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (n = 1000, <span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   Mean (SD): 1.471 (15.87)</span></span>
<span><span class="co">#&gt;   Coverage intervals: 95% [-29.499, 38.622]</span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, 950]: 1614.328 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -550]: 10.024 <span style="color: #B2B2B2; font-style: italic;">(p=0.2977)</span></span></span>
<span><span class="co">#&gt;   [-450, -400]: 8.826 <span style="color: #B2B2B2; font-style: italic;">(p=0.3506)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -350]: 40.580 <span style="font-style: italic;">(p=0.0380)</span></span></span>
<span><span class="co">#&gt;   [0, 250]: 47.066 <span style="font-style: italic;">(p=0.0270)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
</details><p>The clusters detected from the 1,000-simulation run are shown
below:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA</span><span class="op">$</span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, 950]: 1614.328 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -550]: 10.024 <span style="color: #B2B2B2; font-style: italic;">(p=0.2977)</span></span></span>
<span><span class="co">#&gt;   [-450, -400]: 8.826 <span style="color: #B2B2B2; font-style: italic;">(p=0.3506)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -350]: 40.580 <span style="font-style: italic;">(p=0.0380)</span></span></span>
<span><span class="co">#&gt;   [0, 250]: 47.066 <span style="font-style: italic;">(p=0.0270)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>We note that:</p>
<ul>
<li><p>For <code>Condition</code>, the CPA detects one large cluster
spanning [-600, 950] which comes out as significant.</p></li>
<li><p>For <code>Lang</code>, the CPA detects two small, non-significant
clusters: [-600, -550] and [-450, -400]. Note that both clusters span
across just two time bins (given the 50ms binning of the data).</p></li>
<li><p>For <code>Conditino:Lang</code>, the CPA detects two significant
clusters spanning [-600, -350] and [0, 250].</p></li>
</ul>
<p>In the following sections we recruit some visual aids to help guide
our interpretation of what exactly the results of the CPA mean in the
context of the data.</p>
</div>
<div class="section level2">
<h2 id="interpreting-the-effects-from-the-cpa">Interpreting the effects from the CPA<a class="anchor" aria-label="anchor" href="#interpreting-the-effects-from-the-cpa"></a>
</h2>
<p>As a reminder, here is what the shape of the data looks like in the
2-by-2 design:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_base</span></span></code></pre></div>
<p><img src="Ito-et-al-2018_files/figure-html/p_base-again-1.png" width="100%"></p>
<p>See the code in the collapsible details if you want to follow along
and reproduce the plots.</p>
<details><summary>
Some setup for the plotting code
</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data frame of detected clusters to annotate on the plots</span></span>
<span><span class="va">clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">CPA</span><span class="op">$</span><span class="va">empirical_clusters</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">pvalue</span> <span class="op">&lt;</span> <span class="fl">0.05</span>, <span class="st">"steelblue"</span>, <span class="st">"grey50"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transparent version of `p_base` to overlay with the effect-plots below</span></span>
<span><span class="va">p_bg</span> <span class="op">&lt;-</span> <span class="va">p_base</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html" class="external-link">alpha</a></span><span class="op">(</span><span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/pal_hue.html" class="external-link">hue_pal</a></span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_void</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
</details><div class="section level3">
<h3 id="main-effect-of-condition">Main effect of <code>Condition</code><a class="anchor" aria-label="anchor" href="#main-effect-of-condition"></a>
</h3>
<p>Given our prior sum coding, the main effect of <code>Condition</code>
estimates the difference in means between <code>Condition=="Targ"</code>
vs. <code>Condition="Unr"</code>. These were differentiated by line type
(solid vs. dashed) in the plot of the data.</p>
<p>One way to visualize this effect is to take the average of the solid
lines and the average of the dashed lines. This shows the difference in
<code>elogFix</code> that is solely on the basis of
<code>Condition</code>.</p>
<details><summary>
Code to plot the <code>Condition</code> main effect
</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_cond</span> <span class="op">&lt;-</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">elogFix</span>, linetype <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, linewidth <span class="op">=</span> <span class="fl">2</span>, fun.data <span class="op">=</span> <span class="va">mean_se</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start</span>, xend <span class="op">=</span> <span class="va">end</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    data <span class="op">=</span> <span class="va">clusters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">predictor</span> <span class="op">==</span> <span class="st">"Condition"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Main effect of Condition"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_cond</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html" class="external-link">inset_element</a></span><span class="op">(</span><span class="va">p_bg</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, align_to <span class="op">=</span> <span class="st">"panel"</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="Ito-et-al-2018_files/figure-html/p_cond-1.png" width="100%"></p>
<p>The one large cluster detected in the CPA (annotated in blue at the
bottom) is consistent with the difference between the
<code>Condition</code> lines we see in the plot: the two lines start out
similar but diverge early on, and the large gap between the two is
sustained throughout. This corresponds to the significant cluster
spanning [-600, 950].</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA</span><span class="op">$</span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, 950]: 1614.328 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -550]: 10.024 <span style="color: #B2B2B2; font-style: italic;">(p=0.2977)</span></span></span>
<span><span class="co">#&gt;   [-450, -400]: 8.826 <span style="color: #B2B2B2; font-style: italic;">(p=0.3506)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -350]: 40.580 <span style="font-style: italic;">(p=0.0380)</span></span></span>
<span><span class="co">#&gt;   [0, 250]: 47.066 <span style="font-style: italic;">(p=0.0270)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="main-effect-of-lang">Main effect of <code>Lang</code><a class="anchor" aria-label="anchor" href="#main-effect-of-lang"></a>
</h3>
<p>Similarly, the main effect of <code>Lang</code> estimates the
difference in means between <code>Lang=="L1"</code>
vs. <code>Lang="L2"</code>. These were differentiated by line color (red
vs. blue) in the plot of the data.</p>
<p>One way to visualize this effect is to take the average of the red
lines and the average of the blue lines. This shows the difference in
<code>elogFix</code> that is solely on the basis of
<code>Lang</code>.</p>
<details><summary>
Code to plot the <code>Lang</code> main effect
</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_lang</span> <span class="op">&lt;-</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">elogFix</span>, color <span class="op">=</span> <span class="va">Lang</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, linewidth <span class="op">=</span> <span class="fl">2</span>, fun.data <span class="op">=</span> <span class="va">mean_se</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start</span>, xend <span class="op">=</span> <span class="va">end</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    data <span class="op">=</span> <span class="va">clusters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">predictor</span> <span class="op">==</span> <span class="st">"Lang"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Main effect of Language"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_lang</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/inset_element.html" class="external-link">inset_element</a></span><span class="op">(</span><span class="va">p_bg</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, align_to <span class="op">=</span> <span class="st">"panel"</span><span class="op">)</span></span></code></pre></div>
</details><p><img src="Ito-et-al-2018_files/figure-html/p_lang-1.png" width="100%"></p>
<p>Two small clusters are annotated in grey around the -500ms mark. From
eye-balling the plot, the clusters appear over regions where the two
lines diverge slightly more than in other places along the time
dimension, but they don’t seem to point out a meaningful pattern of
difference. These correspond to the two non-significant clusters
spanning [-600, -550] and [-450, -400].</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA</span><span class="op">$</span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, 950]: 1614.328 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -550]: 10.024 <span style="color: #B2B2B2; font-style: italic;">(p=0.2977)</span></span></span>
<span><span class="co">#&gt;   [-450, -400]: 8.826 <span style="color: #B2B2B2; font-style: italic;">(p=0.3506)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -350]: 40.580 <span style="font-style: italic;">(p=0.0380)</span></span></span>
<span><span class="co">#&gt;   [0, 250]: 47.066 <span style="font-style: italic;">(p=0.0270)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>As an aside, you may have noticed in the plot that there’s actually
an even larger divergence between lines around the 200ms mark, where the
blue line for L2 speakers noticeably dip. Part of the reason why this is
not detected as a cluster is because the difference at that region is
not robust after accounting for variability due to the the random
effects. See the collapsible details below for a proof.</p>
<details><summary>
Clusters identified using fixed-effect models
</summary><p>A less sensitive CPA using fixed-effect models will actually pick out
that numerically larger difference between the <code>Lang</code> lines,
over the region [100, 350].</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">elogFix</span> <span class="op">~</span> <span class="va">Condition</span> <span class="op">*</span> <span class="va">Lang</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fix_50bin</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Subject"</span>, trial <span class="op">=</span> <span class="st">"Item"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">timewise_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_timewise_statistics.html">compute_timewise_statistics</a></span><span class="op">(</span><span class="va">spec_lm</span>, statistic <span class="op">=</span> <span class="st">"chisq"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/extract_empirical_clusters.html">extract_empirical_clusters</a></span><span class="op">(</span><span class="va">timewise_lm</span>, threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, 950]: 1475.084</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -550]: 9.014</span></span>
<span><span class="co">#&gt;   [100, 350]: 29.469</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -350]: 37.925</span></span>
<span><span class="co">#&gt;   [0, 200]: 39.343</span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>To assess what’s going on, we can zoom in and fit models on the data
over that region.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fix_50bin_100_350</span> <span class="op">&lt;-</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">Time</span>, <span class="fl">100</span>, <span class="fl">350</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spec_lm_100_350</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">elogFix</span> <span class="op">~</span> <span class="va">Condition</span> <span class="op">*</span> <span class="va">Lang</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fix_50bin_100_350</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Subject"</span>, trial <span class="op">=</span> <span class="st">"Item"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lm_100_350</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jlmer.html">jlmer</a></span><span class="op">(</span><span class="va">spec_lm_100_350</span><span class="op">)</span></span>
<span></span>
<span><span class="va">spec_lmer_100_350</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">elogFix</span> <span class="op">~</span> <span class="va">Condition</span> <span class="op">*</span> <span class="va">Lang</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Item</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fix_50bin_100_350</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Subject"</span>, trial <span class="op">=</span> <span class="st">"Item"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">lmer_100_350</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/jlmer.html">jlmer</a></span><span class="op">(</span><span class="va">spec_lmer_100_350</span><span class="op">)</span></span></code></pre></div>
<p>As expected, there’s a much larger standard error for
<code>Lang</code> in the mixed model compared to the fixed model:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  lm <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">lm_100_350</span><span class="op">)</span>,</span>
<span>  lmer <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">lmer_100_350</span><span class="op">)</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"model"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"Lang1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span><span class="op">:</span><span class="va">statistic</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   model term  estimate std.error statistic</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> lm    Lang1    0.369    0.068<span style="text-decoration: underline;">6</span>      5.38</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lmer  Lang1    0.358    0.202       1.77</span></span></code></pre></div>
<p>The estimates on the coefficient are otherwise similar, so the random
effects must be soaking up some of the variation that the fixed model is
(unwittingly) attributing to the effect of <code>Lang</code>. (Or if
you’d prefer it said the other way, the random effects must be
preventing the fixed effect from soaking up the residual variation).</p>
<p>Indeed, beyond the shared estimate for the residual standard
deviation of around 3, the mixed model is additionally attributes a
large effect of 1.3 for by-subject intercepts.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">lmer_100_350</span>, effects <span class="op">=</span> <span class="st">"ran_pars"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="st">"lmer"</span>, .before <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html" class="external-link">add_row</a></span><span class="op">(</span></span>
<span>    model <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Residual"</span>,</span>
<span>    term <span class="op">=</span> <span class="st">"sd__Observation"</span>,</span>
<span>    estimate <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">lm_100_350</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   model group    term            estimate</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> lmer  Subject  sd__(Intercept)    1.33 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lmer  Item     sd__(Intercept)    0.459</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> lmer  Residual sd__Observation    2.84 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> lm    Residual sd__Observation    3.18</span></span></code></pre></div>
<p>As a last sanity check, we compare goodness-of-fit and err on the
side of mixed models:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  lm <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">lm_100_350</span><span class="op">)</span>,</span>
<span>  lmer <span class="op">=</span> <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">lmer_100_350</span><span class="op">)</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"model"</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">df</span>, <span class="va">logLik</span>, <span class="va">AIC</span>, <span class="va">BIC</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   model    df logLik    AIC    BIC</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> lm        5 -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">543.</span> <span style="text-decoration: underline;">11</span>096. <span style="text-decoration: underline;">11</span>124.</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> lmer      7 -<span style="color: #BB0000; text-decoration: underline;">5</span><span style="color: #BB0000;">375.</span> <span style="text-decoration: underline;">10</span>764. <span style="text-decoration: underline;">10</span>804.</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="interaction-effect-of-conditionlang">Interaction effect of <code>Condition:Lang</code><a class="anchor" aria-label="anchor" href="#interaction-effect-of-conditionlang"></a>
</h3>
<p>The interaction effect can be slightly trickier to interpret, but one
intuitive way to think about it here is: “Does <code>Condition</code>
show different effects between the <code>Lang=="L1"</code> group and the
<code>Lang=="L2"</code> group?”. You could also frame this the other way
around as “Is the effect of <code>Lang</code> different between
<code>Condition</code> groups?”, but the original framing makes more
sense in the context of the study.</p>
<p>One way to visualize this is to first plot the difference between
lines as shaded areas. Then, we can inspect whether the area of
difference within the <code>Lang=="L1"</code> group is larger/smaller
than the area of difference within the <code>Lang=="L2"</code>
group.</p>
<details><summary>
Code to plot the <code>Condition:Lang</code> interaction effect
</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For drawing areas</span></span>
<span><span class="va">braid_layer</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">Lang_group</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Lang_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.arg.html" class="external-link">match.arg</a></span><span class="op">(</span><span class="va">Lang_group</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://nsgrantham.github.io/ggbraid/reference/geom_braid.html" class="external-link">geom_braid</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Time</span>, ymin <span class="op">=</span> <span class="va">Unr</span>, ymax <span class="op">=</span> <span class="va">Targ</span>,</span>
<span>        fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Targ</span> <span class="op">&gt;</span> <span class="va">Unr</span>, <span class="st">"grey"</span>, <span class="st">"grey30"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    data <span class="op">=</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>        id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">Lang</span>, <span class="va">Time</span><span class="op">)</span>,</span>
<span>        names_from <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>        values_from <span class="op">=</span> <span class="st">"elogFix"</span>,</span>
<span>        values_fn <span class="op">=</span> <span class="va">mean</span></span>
<span>      <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Lang</span> <span class="op">==</span> <span class="va">.env</span><span class="op">$</span><span class="va">Lang_group</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">p_interaction</span> <span class="op">&lt;-</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">elogFix</span>, color <span class="op">=</span> <span class="va">Lang</span>, linetype <span class="op">=</span> <span class="va">Condition</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span>, linewidth <span class="op">=</span> <span class="fl">2</span>, fun.data <span class="op">=</span> <span class="va">mean_se</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">braid_layer</span><span class="op">(</span><span class="st">"L1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">braid_layer</span><span class="op">(</span><span class="st">"L2"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html" class="external-link">geom_segment</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">start</span>, xend <span class="op">=</span> <span class="va">end</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    data <span class="op">=</span> <span class="va">clusters</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">predictor</span> <span class="op">==</span> <span class="st">"Condition:Lang"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Interaction between Condition and Language"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html" class="external-link">scale_fill_identity</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_interaction</span></span></code></pre></div>
</details><p><img src="Ito-et-al-2018_files/figure-html/p_interaction-1.png" width="100%"></p>
<p>Overall, we see a larger effect of <code>Condition</code> materialize
within <code>Lang=="L1"</code> (area between red lines) than within
<code>Lang=="L2"</code> (area between blue lines). The two clusters for
the interaction effect are detected over the regions where this
difference in area is the most pronounced. These correspond to the two
significant clusters spanning [-600, -350] and [0, 250].</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA</span><span class="op">$</span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, 950]: 1614.328 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -550]: 10.024 <span style="color: #B2B2B2; font-style: italic;">(p=0.2977)</span></span></span>
<span><span class="co">#&gt;   [-450, -400]: 8.826 <span style="color: #B2B2B2; font-style: italic;">(p=0.3506)</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition:Lang</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-600, -350]: 40.580 <span style="font-style: italic;">(p=0.0380)</span></span></span>
<span><span class="co">#&gt;   [0, 250]: 47.066 <span style="font-style: italic;">(p=0.0270)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-to-a-split-approach">Comparison to a split approach<a class="anchor" aria-label="anchor" href="#comparison-to-a-split-approach"></a>
</h2>
<p>At the beginning of this tutorial we discussed an alternative
approach of splitting the data by one factor and then testing the effect
of the other factor within each level of the first factor. In this
section we replicate this approach from the original tutorial for this
dataset, where the effect of <code>Condition</code> was tested
separately for each group of <code>Lang</code>.</p>
<p>We first split the data by <code>Lang</code> and construct a
specification object for each. Note that <code>Condition</code> is now
the sole predictor in the formulae.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec_L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">elogFix</span> <span class="op">~</span> <span class="va">Condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Item</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Lang</span> <span class="op">==</span> <span class="st">"L1"</span><span class="op">)</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Subject"</span>, trial <span class="op">=</span> <span class="st">"Item"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">spec_L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  <span class="va">elogFix</span> <span class="op">~</span> <span class="va">Condition</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Item</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fix_50bin</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Lang</span> <span class="op">==</span> <span class="st">"L2"</span><span class="op">)</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Subject"</span>, trial <span class="op">=</span> <span class="st">"Item"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, we conduct a CPA for each, using the same
<code><a href="../reference/clusterpermute.html">clusterpermute()</a></code> syntax.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/julia_rng.html">set_rng_state</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">CPA_L1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterpermute.html">clusterpermute</a></span><span class="op">(</span></span>
<span>    <span class="va">spec_L1</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    nsim <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.12    0.11   25.35</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/julia_rng.html">set_rng_state</a></span><span class="op">(</span><span class="fl">123L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">CPA_L2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterpermute.html">clusterpermute</a></span><span class="op">(</span></span>
<span>    <span class="va">spec_L2</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    threshold <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    nsim <span class="op">=</span> <span class="fl">1000L</span>,</span>
<span>    progress <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.08    0.11   19.11</span></span></code></pre></div>
<p>Finally we inspect the result of the CPA on the splits:</p>
<p>For the L1 group, we detect one significant cluster spanning [-650,
950], which has the same range as the cluster detected for the
<code>Condition</code> main effect in the combined CPA.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA_L1</span><span class="op">$</span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-650, 950]: 1031.778 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>For the L2 group, we again detect one significant cluster but now
spanning a slightly shorter range of [-350, 950].</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CPA_L2</span><span class="op">$</span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Empirical clusters</span> (chisq p &lt; <span style="color: #0000BB;">0.05</span>) ───────────────── <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Condition</span> (<span style="font-style: italic;">df = 1</span>)</span></span>
<span><span class="co">#&gt;   [-350, 950]: 620.678 <span style="font-style: italic;">(p=0.0010)</span></span></span>
<span><span class="co">#&gt; ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre></div>
<p>It is important to note that within this split analysis, we cannot
compare the <code>Condition</code> effect across <code>Lang</code>
groups. This is not just on the basis of such a comparison being a
post-hoc test, thus carrying less weight as a piece of evidence.
Instead, there is a more fundamental problem in the fact that the
magnitude of the effect (i.e., the cluster-mass statistic) is an
abstraction over the shape of the data (and permutations of the data) as
a <em>time series</em>, which cannot be recovered post-hoc.</p>
<p>More simply put, given the cluster-mass of 1032 over [-650, 950] for
native speakers and the cluster-mass of 621 over [-350, 950] for
non-native speakers, we cannot conclude a difference in cluster-mass of
411 over the non-intersecting region [-650, -350].</p>
<p>Here, we already know that this isn’t the case: the complete 2-by-2
CPA from above detected significant clusters for the interaction effect
at [-600, -350] and [0, 250], each with a smaller cluster-mass. Thus, we
can only get an estimate this effect if the comparison is specified at
the start and baked into the CPA procedure itself (here, in the form of
an interaction term, with the appropriate contrast coding schemes).</p>
<p>Lastly, as also noted elsewhere on the package website, be careful of
making statements about the timecourse of an effect from a CPA (<a href="https://doi.org/10.1111/psyp.13335" class="external-link">Sassenhagen &amp; Draschkow,
2019</a>).</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://yjunechoe.github.io" class="external-link">June Choe</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
