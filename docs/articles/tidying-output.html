<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Collecting {jlmerclusterperm} objects as tidy data frames">
<title>Tidying output â€¢ jlmerclusterperm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Atkinson_Hyperlegible-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Tidying output">
<meta property="og:description" content="Collecting {jlmerclusterperm} objects as tidy data frames">
<meta property="og:image" content="https://yjunechoe.github.io/jlmerclusterperm/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jlmerclusterperm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/jlmerclusterperm.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Topics</h6>
    <a class="dropdown-item" href="../articles/tidying-output.html">Tidying output</a>
    <a class="dropdown-item" href="../articles/julia-interface.html">Julia interface</a>
    <a class="dropdown-item" href="../articles/reproducibility.html">Reproducibility</a>
    <a class="dropdown-item" href="../articles/asynchronous-cpa.html">Asynchronous CPA</a>
    <a class="dropdown-item" href="../articles/eyetrackingR-comparison.html">Comparison to eyetrackingR</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Case Studies</h6>
    <a class="dropdown-item" href="../articles/Garrison-et-al-2020.html">Garrison et al. 2020</a>
    <a class="dropdown-item" href="../articles/Geller-et-al-2020.html">Geller et al. 2020</a>
    <a class="dropdown-item" href="../articles/deCarvalho-et-al-2021.html">de Carvalho et al. 2021</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/yjunechoe/jlmerclusterperm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidying output</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yjunechoe/jlmerclusterperm/blob/HEAD/vignettes/articles/tidying-output.Rmd" class="external-link"><code>vignettes/articles/tidying-output.Rmd</code></a></small>
      <div class="d-none name"><code>tidying-output.Rmd</code></div>
    </div>

    
    
<p>This vignette showcases <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> and other ways of
collecting <a href="https://github.com/yjunechoe/jlmerclusterperm" class="external-link">jlmerclusterperm</a> objects as <a href="https://r4ds.had.co.nz/tidy-data.html" class="external-link">tidy data</a>.</p>
<p>See more tutorials and vignettes on the <a href="https://yjunechoe.github.io/jlmerclusterperm/articles">Articles</a>
page.</p>
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yjunechoe/jlmerclusterperm" class="external-link">jlmerclusterperm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/jlmerclusterperm_setup.html">jlmerclusterperm_setup</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/julia_progress.html">julia_progress</a></span><span class="op">(</span>show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Minimal example data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">chickweights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">ChickWeight</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>diet <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_collapse.html" class="external-link">fct_collapse</a></span><span class="op">(</span><span class="va">Diet</span>, A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">chickweights</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">Time</span>, <span class="va">weight</span>, color <span class="op">=</span> <span class="va">diet</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1.96</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"line"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidying-output_files/figure-html/MWE-setup-1.png" width="100%"></p>
<p>The jlmer specification object used for this showcase:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jlmer_spec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_jlmer_spec.html">make_jlmer_spec</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">weight</span> <span class="op">~</span> <span class="va">diet</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Chick</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">chickweights</span>,</span>
<span>  subject <span class="op">=</span> <span class="st">"Chick"</span>, time <span class="op">=</span> <span class="st">"Time"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">jlmer_spec</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">jlmer specification</span> â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span style="color: #0000BB;">&lt;jlmer_spec&gt;</span> â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Formula</span>: weight ~ 1 + dietB + (1 | Chick)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Predictors</span>:</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">diet</span>: dietB</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Groupings</span>:</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">Subject</span>: Chick</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">Trial</span>:</span></span>
<span><span class="co">#&gt;   <span style="font-style: italic;">Time</span>: Time</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">Data</span>:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 533 Ã— 4</span></span></span>
<span><span class="co">#&gt;   weight dietB Chick  Time</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     42     0 1         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     51     0 1         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     59     0 1         4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 530 more rows</span></span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="a-tour-of-tidy-methods">A tour of <code>tidy()</code> methods<a class="anchor" aria-label="anchor" href="#a-tour-of-tidy-methods"></a>
</h2>
<p>All non-<code>&lt;data.frame&gt;</code> objects returned by
<code>jlmerclusterperm</code> functions have a <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>
method to return a data frame representation of the object.</p>
<div class="section level3">
<h3 id="timewise_statistics-objects">
<code>&lt;timewise_statistics&gt;</code> objects<a class="anchor" aria-label="anchor" href="#timewise_statistics-objects"></a>
</h3>
<p>Functions <code><a href="../reference/compute_timewise_statistics.html">compute_timewise_statistics()</a></code> and
<code><a href="../reference/permute_timewise_statistics.html">permute_timewise_statistics()</a></code> return an object of class
<code>&lt;timewise_statistics&gt;</code>, which is an array of
statistics. Note that there isnâ€™t a stylized <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method
for this class.</p>
<p>Instead, it is recommended to use <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> to inspect the
results as a data frame where each statistic is represented as a
row.</p>
<p>In the case of <code><a href="../reference/compute_timewise_statistics.html">compute_timewise_statistics()</a></code>, the output
is a matrix (2D array) of predictor and time. Each dimension becomes a
column in the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> data:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">empirical_statistics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compute_timewise_statistics.html">compute_timewise_statistics</a></span><span class="op">(</span><span class="va">jlmer_spec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">empirical_statistics</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "timewise_statistics"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">empirical_statistics</span><span class="op">)</span> <span class="co"># predictor x time</span></span>
<span><span class="co">#&gt; [1]  1 11</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">empirical_statistics</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 Ã— 3</span></span></span>
<span><span class="co">#&gt;    predictor  time statistic</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dietB         0    -<span style="color: #BB0000;">1.09</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dietB         2     2.29 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dietB         4     3.14 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> dietB         6     4.01 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dietB         8     2.90 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> dietB        10     2.44 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> dietB        12     2.18 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> dietB        14     1.26 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dietB        16     0.673</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> dietB        18     0.532</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> dietB        20     0.809</span></span></code></pre></div>
<p>In the case of <code><a href="../reference/compute_timewise_statistics.html">compute_timewise_statistics()</a></code>, the output
is a 3D array of simulation, time, and predictor. Again, each dimension
becomes a column in the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_statistics</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/permute_timewise_statistics.html">permute_timewise_statistics</a></span><span class="op">(</span><span class="va">jlmer_spec</span>, nsim <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">null_statistics</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "timewise_statistics"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">null_statistics</span><span class="op">)</span> <span class="co"># simulation x time x predictor</span></span>
<span><span class="co">#&gt; [1] 1000   11    1</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">null_statistics</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11,000 Ã— 4</span></span></span>
<span><span class="co">#&gt;    predictor  time statistic sim  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dietB         0   -<span style="color: #BB0000;">0.309</span>  0001 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dietB         0    2.10   0002 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dietB         0   -<span style="color: #BB0000;">2.83</span>   0003 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> dietB         0   -<span style="color: #BB0000;">0.568</span>  0004 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dietB         0    2.10   0005 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> dietB         0   -<span style="color: #BB0000;">1.09</span>   0006 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> dietB         0   -<span style="color: #BB0000;">0.830</span>  0007 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> dietB         0   -<span style="color: #BB0000;">0.051</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0008 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dietB         0   -<span style="color: #BB0000;">0.051</span><span style="color: #BB0000; text-decoration: underline;">5</span> 0009 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> dietB         0    0.206  0010 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 10,990 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="empirical_clusters-objects">
<code>&lt;empirical_clusters&gt;</code> objects<a class="anchor" aria-label="anchor" href="#empirical_clusters-objects"></a>
</h3>
<p>The <code>&lt;empirical_clusters&gt;</code> object returned by
<code><a href="../reference/extract_empirical_clusters.html">extract_empirical_clusters()</a></code> does have a print method
defined, which makes it easier on the eye:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">empirical_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_empirical_clusters.html">extract_empirical_clusters</a></span><span class="op">(</span><span class="va">empirical_statistics</span>, threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">empirical_clusters</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "empirical_clusters"</span></span>
<span><span class="va">empirical_clusters</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Empirical clusters</span> (t &gt; <span style="color: #0000BB;">1</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dietB</span></span></span>
<span><span class="co">#&gt;   [2, 14]: 18.231</span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></code></pre></div>
<p>The <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> data frame representation also contains
information like <code>length</code>, which is the number of time points
that the cluster spans. The <code>id</code> variable uniquely identifies
a cluster within each predictor.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">empirical_clusters</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 6</span></span></span>
<span><span class="co">#&gt;   predictor id    start   end length sum_statistic</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> dietB     1         2    14      7          18.2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="null_cluster_dists-objects">
<code>&lt;null_cluster_dists&gt;</code> objects<a class="anchor" aria-label="anchor" href="#null_cluster_dists-objects"></a>
</h3>
<p>The <code>&lt;null_cluster_dists&gt;</code> object returned by
<code><a href="../reference/extract_null_cluster_dists.html">extract_null_cluster_dists()</a></code> also has a print method
defined, which displays summary statistics:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_cluster_dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_null_cluster_dists.html">extract_null_cluster_dists</a></span><span class="op">(</span><span class="va">null_statistics</span>, threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">null_cluster_dists</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "null_cluster_dists"</span></span>
<span><span class="va">null_cluster_dists</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Null cluster-mass distribution</span> (t &gt; <span style="color: #0000BB;">1</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span style="color: #0000BB;">&lt;null_cluster_dists&gt;</span> â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dietB</span> (n = 1000)</span></span>
<span><span class="co">#&gt;   Mean (SD): 0.014 (7.11)</span></span>
<span><span class="co">#&gt;   Coverage intervals: 95% [-15.360, 15.902]</span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></code></pre></div>
<p>The null distribution is constructed from the largest cluster-mass
statistic observed in each of the bootstrapped permutations of the
original data. In other words, each simulation contributes one sample to
the null.</p>
<p>In the <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> representation, each simulation of a
predictor represents a row. The <code>sum_statistic</code> column
represents the size of the <em>largest</em> cluster from each
simulation. When no clusters are found, the column is zero and values
for <code>start</code>, <code>end</code>, and <code>length</code> are
<code>NA</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">null_cluster_dists</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 Ã— 6</span></span></span>
<span><span class="co">#&gt;    predictor start   end length sum_statistic sim  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dietB         8    20      7         11.1  0001 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dietB         6    10      3          3.75 0002 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dietB        18    20      2          2.07 0003 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> dietB         2    10      5          6.00 0004 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dietB         4    10      4          5.91 0005 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0006 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> dietB         8    20      7         12.2  0007 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> dietB         2     8      4          5.29 0008 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0009 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0010 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 990 more rows</span></span></span></code></pre></div>
<p>The output of <code>tidy(null_statistics)</code> and
<code>tidy(null_cluster_dists)</code> form a relational data. For
example, you can use <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> to find the time wise
statistics of the permuted data with the most extreme cluster-mass
statistic:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">largest_permuted_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">null_cluster_dists</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">sum_statistic</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">null_statistics</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"predictor"</span>, <span class="st">"sim"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">largest_permuted_cluster</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 Ã— 8</span></span></span>
<span><span class="co">#&gt;    predictor start   end length sum_statistic sim    time statistic</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dietB         2    20     10          29.4 0319      0     -<span style="color: #BB0000;">1.09</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dietB         2    20     10          29.4 0319      2      1.67</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dietB         2    20     10          29.4 0319      4      2.56</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> dietB         2    20     10          29.4 0319      6      2.97</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dietB         2    20     10          29.4 0319      8      3.47</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> dietB         2    20     10          29.4 0319     10      3.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> dietB         2    20     10          29.4 0319     12      3.49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> dietB         2    20     10          29.4 0319     14      3.54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dietB         2    20     10          29.4 0319     16      3.05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> dietB         2    20     10          29.4 0319     18      2.65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> dietB         2    20     10          29.4 0319     20      2.48</span></span></code></pre></div>
<p>Note that the <code>sum_statistic</code> is simply the sum of the
<code>statistic</code> values over the span of the largest cluster:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">largest_permuted_cluster</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">start</span>, <span class="va">end</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>sum_statistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sum_statistic</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 2</span></span></span>
<span><span class="co">#&gt;   sum_statistic `sum(statistic)`</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>          29.4             29.4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="in-other-contexts">In other contexts<a class="anchor" aria-label="anchor" href="#in-other-contexts"></a>
</h3>
<p>The output of <code><a href="../reference/calculate_clusters_pvalues.html">calculate_clusters_pvalues()</a></code> is just an
<code>&lt;empirical_clusters&gt;</code> object that has been augmented
with p-values:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tested_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_clusters_pvalues.html">calculate_clusters_pvalues</a></span><span class="op">(</span><span class="va">empirical_clusters</span>, <span class="va">null_cluster_dists</span><span class="op">)</span></span>
<span><span class="va">tested_clusters</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Empirical clusters</span> (t &gt; <span style="color: #0000BB;">1</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dietB</span></span></span>
<span><span class="co">#&gt;   [2, 14]: 18.231 <span style="font-style: italic;">(p=0.0270)</span></span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></code></pre></div>
<p>When available, p-values are returned as a column in the
<code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> data:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">tested_clusters</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 7</span></span></span>
<span><span class="co">#&gt;   predictor id    start   end length sum_statistic pvalue</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> dietB     1         2    14      7          18.2  0.027</span></span></code></pre></div>
<p>Note that the p-value for this cluster is 0.027 because there are 27
samples from the null that are as or more extreme than the observed:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">null_cluster_dists</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">sum_statistic</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">tested_clusters</span><span class="op">)</span><span class="op">$</span><span class="va">sum_statistic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 27 Ã— 6</span></span></span>
<span><span class="co">#&gt;    predictor start   end length sum_statistic sim  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dietB         0    20     11         -<span style="color: #BB0000;">18.7</span> 0072 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dietB         0    20     11         -<span style="color: #BB0000;">19.4</span> 0114 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dietB         6    20      8          19.0 0118 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> dietB         0    20     11         -<span style="color: #BB0000;">23.6</span> 0137 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dietB         4    20      9         -<span style="color: #BB0000;">21.7</span> 0142 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> dietB         2    20     10          24.7 0268 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> dietB         4    20      9          22.7 0289 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> dietB         2    20     10          29.4 0319 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dietB         2    20     10          26.4 0325 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> dietB         4    20      9          26.5 0384 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 17 more rows</span></span></span></code></pre></div>
<p>In the case of the one-fell-swoop function
<code><a href="../reference/clusterpermute.html">clusterpermute()</a></code>, the
<code>&lt;null_cluster_dists&gt;</code> object and the
<code>&lt;empirical_clusters&gt;</code> object are returned in a
list:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Timing the entire process this time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">full_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterpermute.html">clusterpermute</a></span><span class="op">(</span><span class="va">jlmer_spec</span>, threshold <span class="op">=</span> <span class="fl">1</span>, nsim <span class="op">=</span> <span class="fl">1000</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;    0.02    0.04    2.12</span></span>
<span><span class="va">full_test</span></span>
<span><span class="co">#&gt; $null_cluster_dists</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Null cluster-mass distribution</span> (t &gt; <span style="color: #0000BB;">1</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span style="color: #0000BB;">&lt;null_cluster_dists&gt;</span> â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dietB</span> (n = 1000)</span></span>
<span><span class="co">#&gt;   Mean (SD): 0.066 (7.61)</span></span>
<span><span class="co">#&gt;   Coverage intervals: 95% [-16.959, 17.216]</span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $empirical_clusters</span></span>
<span><span class="co">#&gt; â”€â”€ <span style="font-weight: bold;">Empirical clusters</span> (t &gt; <span style="color: #0000BB;">1</span>) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ <span style="color: #0000BB;">&lt;empirical_clusters&gt;</span> â”€â”€</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dietB</span></span></span>
<span><span class="co">#&gt;   [2, 14]: 18.231 <span style="font-style: italic;">(p=0.0420)</span></span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></code></pre></div>
<p>You can <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> the elements of this list with
<code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> or <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">purrr::map()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">full_test</span>, <span class="va">tidy</span><span class="op">)</span></span>
<span><span class="co">#&gt; $null_cluster_dists</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,000 Ã— 6</span></span></span>
<span><span class="co">#&gt;    predictor start   end length sum_statistic sim  </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> dietB        14    20      4         -<span style="color: #BB0000;">5.26</span> 0001 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> dietB        14    20      4          9.22 0002 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> dietB         6    20      8         11.8  0003 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0004 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0005 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> dietB        16    20      3         -<span style="color: #BB0000;">3.69</span> 0006 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> dietB        14    20      4          6.23 0007 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0008 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> dietB        12    20      5          5.38 0009 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> dietB        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>          0    0010 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 990 more rows</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $empirical_clusters</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 7</span></span></span>
<span><span class="co">#&gt;   predictor id    start   end length sum_statistic pvalue</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> dietB     1         2    14      7          18.2 0.042<span style="text-decoration: underline;">0</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="tidying-julia-model-objects">Tidying Julia model objects<a class="anchor" aria-label="anchor" href="#tidying-julia-model-objects"></a>
</h2>
<p>Functions <code><a href="../reference/jlmer.html">jlmer()</a></code> and <code><a href="../reference/to_jlmer.html">to_jlmer()</a></code> return an
object of class <code>&lt;jlmer_mod&gt;</code>, which is a <a href="https://github.com/stefan-m-lenz/JuliaConnectoR" class="external-link"><code>JuliaConnectoR</code></a>
pointer to the Julia model object:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jlmer_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/to_jlmer.html">to_jlmer</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">diet</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Chick</span><span class="op">)</span>, <span class="va">chickweights</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">jlmer_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "jlmer_mod"        "JuliaStructProxy" "JuliaProxy"</span></span>
<span><span class="va">jlmer_mod</span></span>
<span><span class="co">#&gt; &lt;Julia object of type LinearMixedModel&gt;</span></span>
<span><span class="co">#&gt; Variance components:</span></span>
<span><span class="co">#&gt;             Column    Variance Std.Dev.</span></span>
<span><span class="co">#&gt; Chick    (Intercept)   305.1809 17.4694</span></span>
<span><span class="co">#&gt; Residual              3854.0809 62.0812</span></span>
<span><span class="co">#&gt;  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt;                 Coef.  Std. Error      z  Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span>
<span><span class="co">#&gt; (Intercept)  108.16       4.76331  22.71    &lt;1e-99</span></span>
<span><span class="co">#&gt; dietB         12.2644     7.45319   1.65    0.0999</span></span>
<span><span class="co">#&gt; â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></code></pre></div>
<p>You can use <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> and <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> to return
information about the Julia model as a data frame:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">jlmer_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 Ã— 7</span></span></span>
<span><span class="co">#&gt;   effect   group    term            estimate std.error statistic    p.value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> fixed    <span style="color: #BB0000;">NA</span>       (Intercept)        108.       4.76     22.7   3.83<span style="color: #949494;">e</span><span style="color: #BB0000;">-114</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> fixed    <span style="color: #BB0000;">NA</span>       dietB               12.3      7.45      1.65  9.99<span style="color: #949494;">e</span><span style="color: #BB0000;">-  2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ran_pars Chick    sd__(Intercept)     17.5     <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   <span style="color: #949494;"> </span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ran_pars Residual sd__Observation     62.1     <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>   <span style="color: #949494;"> </span></span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">jlmer_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 8</span></span></span>
<span><span class="co">#&gt;    nobs    df sigma logLik   AIC   BIC deviance df.residual</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   533     4  62.1 -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">972.</span> <span style="text-decoration: underline;">5</span>952. <span style="text-decoration: underline;">5</span>969.    <span style="text-decoration: underline;">5</span>944.         529</span></span></code></pre></div>
<p>These mimic the behavior of the same methods from
<a href="https://broom.tidymodels.org/" class="external-link">broom</a>/<a href="https://github.com/bbolker/broom.mixed" class="external-link">broom.mixed</a> defined for
<code>(g)lm</code>/<code>(g)lmer</code> models:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bbolker/broom.mixed" class="external-link">broom.mixed</a></span><span class="op">)</span></span>
<span><span class="va">lmer_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">diet</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">Chick</span><span class="op">)</span>, <span class="va">chickweights</span>, REML <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">lmer_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 Ã— 6</span></span></span>
<span><span class="co">#&gt;   effect   group    term            estimate std.error statistic</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> fixed    <span style="color: #BB0000;">NA</span>       (Intercept)        108.       4.76     22.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> fixed    <span style="color: #BB0000;">NA</span>       dietB               12.3      7.45      1.65</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ran_pars Chick    sd__(Intercept)     17.5     <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ran_pars Residual sd__Observation     62.1     <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance</a></span><span class="op">(</span><span class="va">lmer_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 7</span></span></span>
<span><span class="co">#&gt;    nobs sigma logLik   AIC   BIC deviance df.residual</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>   533  62.1 -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">972.</span> <span style="text-decoration: underline;">5</span>952. <span style="text-decoration: underline;">5</span>969.    <span style="text-decoration: underline;">5</span>944.         529</span></span></code></pre></div>
<p>Note that Julia <a href="https://github.com/JuliaStats/MixedModels.jl" class="external-link">MixedModels.jl</a>
defaults to <code>REML = FALSE</code>, whereas it is <code>TRUE</code>
by default in <a href="https://github.com/lme4/lme4/" class="external-link">lme4</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://yjunechoe.github.io" class="external-link">June Choe</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
